# 3. 발주년월 수식 자동 생성

## 대상

엑셀 1도 모르는 엑셀 초보자이지만, 해야할 일을 말로는 설명할 수 있는 분.

## 샘플 파일 다운로드

+ 아래의 샘플파일을 [다운로드](./assets/recipes-excel-04.xlsx)하신 후에 열어주세요.
+ VBA 코드도 없는 순수하게 데이터만 입력된 엑셀 파일입니다.
+ 어떤 엑셀 파일이라도 열려만 있다면 "클로드 + 파이썬사랑방 MCP 도구" 조합이 가능합니다. 

[![](./assets/01-excel.png#noborder)](./assets/recipes-excel-04.xlsx)

## 하고자 하는 일

위 데이터에서 "발주일자" 컬럼으로부터 "발주년월" 컬럼을 생성하고 싶어요.
엑셀을 잘하시는 분이라면 수식을 입력해서 손쉽게 처리하시겠지만,
"엑셀을 1도 모르시는 엑셀 초보자"는 어떤 네이버 검색이나 ChatGPT에게 물어보겠죠.

네이버 검색이나 ChatGPT를 통해서 답을 찾을 순 있겠지만, 우리의 데이터에 맞게 알아서 처리해주진 않습니다.

## 클로드에게 요청해봅시다.

아래와 같이 할 일을 설명만 할 수 있으면 됩니다. 그럼 클로드에서 판단해서 "파이썬사랑방 MCP 도구"를 활용해서 (아래에 계속)

``` title="프롬프트"
활성화된 엑셀 시트의 A1 좌표의 테이블 데이터에서 발주일자 컬럼을 읽고, 옆에 발주년월 컬럼을 추가해줘.
year-month 계산은 엑셀 수식으로 해줘.
```

![](./assets/02-claude.png#noborder)

1. 대상을 **"활성화된 엑셀 시트의 A1 좌표의 테이블 데이터"** 라고 지정해줬구요.
2. **"발주년월 컬럼을 추가"**라는 말에 새 컬럼을 추가하고
3. **"year-month 계산은 엑셀 수식으로 해줘.**" 라는 말에 클로드가 "년-월"을 계산해서 넣지 않고, 엑셀 수식을 **"=TEXT(D2, "yyyy-mm")"**
   로 자동지정되어,


짠!!! 이렇게 "발주년월" 컬럼 데이터가 올바르게 생성되었음을 확인하실 수 있습니다.
수식까지 기가 막히게 잘 들어갔어요. 🤩

![](./assets/03-excel.png#noborder)
